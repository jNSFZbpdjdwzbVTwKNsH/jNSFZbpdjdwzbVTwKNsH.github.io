---
title: 28/10
layout: page
author: Carlo Rosso
date: 2025-10-28
---

Traceback (most recent call last):
  File "/work/ATDL-SoftWeightSharing/scripts/tune_optuna.py", line 321, in <module>
    main()
  File "/work/ATDL-SoftWeightSharing/scripts/tune_optuna.py", line 252, in main
    study.optimize(
  File "/home/ucloud/.local/lib/python3.12/site-packages/optuna/study/study.py", line 490, in optimize
    _optimize(
  File "/home/ucloud/.local/lib/python3.12/site-packages/optuna/study/_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "/home/ucloud/.local/lib/python3.12/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial_id = _run_trial(study, func, catch)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ucloud/.local/lib/python3.12/site-packages/optuna/study/_optimize.py", line 258, in _run_trial
    raise func_err
  File "/home/ucloud/.local/lib/python3.12/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/work/ATDL-SoftWeightSharing/scripts/tune_optuna.py", line 253, in <lambda>
    lambda trial: objective(trial, args, data_provider),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/ATDL-SoftWeightSharing/scripts/tune_optuna.py", line 116, in objective
    prior = MixturePrior(
            ^^^^^^^^^^^^^
  File "/work/ATDL-SoftWeightSharing/src/atdl_sws/prior.py", line 102, in __init__
    _ = self(weights)
        ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/work/ATDL-SoftWeightSharing/src/atdl_sws/prior.py", line 106, in build
    self.mu = self.add_weight(
              ^^^^^^^^^^^^^^^^
ValueError: Could not interpret initializer identifier: [-0.23346242 -0.20233597 -0.17120952 -0.14008306 -0.10895661 -0.07783016
 -0.0467037  -0.01557725  0.0155492   0.04667566  0.07780211  0.10892857
  0.14005502  0.17118147  0.20230793  0.23343438]


  ---

  '+ptx85' is not a recognized feature for this target (ignoring feature)                                                                      
'+ptx85' is not a recognized feature for this target (ignoring feature)                                                                      
Error during retraining: Could not interpret optimizer identifier: <tf_keras.src.optimizers.adam.Adam object at 0x7f1395860c80>              
[I 2025-10-28 23:32:04,287] Trial 0 finished with values: [inf, 0.0] and parameters: {'tau': 3.1489116479568635e-05, 'lr_w': 0.03285970816964
246, 'lr_mu': 0.001570297088405539, 'lr_sigma': 0.0006251373574521745, 'lr_pi': 2.9380279387035334e-05, 'prior_pi0': 0.8310429095469044, 'pri
or_init_sigma': 0.12323344486727979, 'prior_gamma_alpha': 86630.99696291602, 'prior_gamma_beta': 60.115490024203446, 'prior_gamma_alpha0': 70
836.45052182494, 'prior_gamma_beta0': 0.4214840409730909}.                                                                                   
  0%|▌                                                                                                       | 1/200 [00:04<15:10,  4.58s/it]
Error during retraining: Could not interpret optimizer identifier: <tf_keras.src.optimizers.adam.Adam object at 0x7f13958b0d70>              
[I 2025-10-28 23:32:04,892] Trial 1 finished with values: [inf, 0.0] and parameters: {'tau': 0.00757947995334801, 'lr_w': 0.01199997548035081
, 'lr_mu': 4.335281794951564e-05, 'lr_sigma': 3.511356313970405e-05, 'lr_pi': 3.5498788321965036e-05, 'prior_pi0': 0.860544206348948, 'prior_
init_sigma': 0.3099025726528951, 'prior_gamma_alpha': 43251.30736234737, 'prior_gamma_beta': 29.13000172840221, 'prior_gamma_alpha0': 61224.1
0418276571, 'prior_gamma_beta0': 2.7984822744343156}.                                                                                        
  1%|█                                                                                                       | 2/200 [00:05<07:23,  2.24s/it]
Error during retraining: Could not interpret optimizer identifier: <tf_keras.src.optimizers.adam.Adam object at 0x7f13958b3590>

---

python scripts/tune_optuna.py --model lenet5 --n-trials 100 --epochs 70 --save-dir runs/optuna_results --visualize --log
python scripts/tune_optuna.py --model lenet300 --n-trials 100 --epochs 70 --save-dir runs/optuna_results --visualize --log
